# 2ch /ai/ wiki

Проект разворачивается здесь:  
https://2ch-ai.gitgud.site/wiki

## Как поставить локально (Windows)
Скачивание проекта и установка зависимостей: 
```
git clone git@ssh.gitgud.io:2ch-ai/wiki.git
cd ./wiki
./install.bat
```

---

Запуск dev-сервера: `watch.bat`

Данная команда позволит вам отслеживать свои правки в режиме реального времени. Используйте её для локального редактирования вики.

---

Сборка проекта: `build.bat`

Данная команда соберёт фронтенд и разместит его в директории `./site`. Используйте её, если собираетесь хостить вики где-либо.

## Инфа про редактирование вики

Редактировать вики можно либо в онлайне либо в оффлайне с последующим пушем правок через гит.

1. Чтобы редачить существующую страницу в онлайне, нужно кликнуть на  кнопку редактирования, которая находится сверху справа на странице
![](https://files.catbox.moe/ulxgzo.png)

2. Так же при просмотре репы можно кликнуть на Open in Web IDE, там откроется онлайн-редактор по типу Atom/VSCode

![](https://files.catbox.moe/oh4ndu.png)

3. Крупные правки по типу запила статей лучше делать локально, чтобы точно видеть, как страница будет выглядеть. Для этого надо клонировать репу, поставить python-зависимости и запустить проект

В вики не используются никакие базы данных и т.п. - здесь просто из кучи md вся статика для сайта собирается. Всё, что нужно для запуска - python+pip в системе.

Для скачивания зависимостей в локальный venv и запуска сервера в watch-режиме (т.е. все правки будут сразу отображаться в браузере) в корне проекта есть скрипты `install.bat` и `watch.bat`

Список страниц для навигатора задаётся в этом файле:  
https://gitgud.io/2ch-ai/wiki/-/blob/master/mkdocs.yml

Инфу про возможности используемого диалекта маркдауна можно глянуть здесь:  
https://squidfunk.github.io/mkdocs-material/reference/admonitions/

В используемом движке есть несколько фишек, доступных только в платной версии движка, которые у нас не будут работать; но и без них функционал гораздо шире чем в rentry. Платные фишки выделены значком сердечка в документации:  
![](https://files.catbox.moe/cmau28.PNG)

### Настройка `.git/config` для локальных правок
Если вы указали своё настоящее имя/email в глобальном гит-конфиге (`C:/Users/%username%/.gitconfig`), то необходимо настроить локальный git-конфиг для проекта, чтобы не коммитить под своими реальными данными.

Назначить имя для текущего проекта:  
`git config user.name "your_name"`

Назначить email для текущего проекта:  
`git config user.email "your@email.com"`

Просмотреть данные, под которыми вы будете коммитить, можно при помощи данных команд:  
`git config user.name`  
`git config user.email`

Настройки имени/email'а для проекта хранятся в файле `.git/config`. Там же можно просмотреть/отредактировать их вручную:
![](https://files.catbox.moe/rzvdlj.PNG)

### Ещё пара нюансов про картинки
1. https://imgur.com/ по какой-то причине не отдаёт никакие картинки для локалхоста, поэтому для них проще юзать https://catbox.moe/
2. При хостинге картинок на самом gitgud он криво отдаёт крупные картинки, типо тех же гридов для SD весом в десятки мегабайт, поэтому картинки лучше кидать не в репу, а на catbox (хотя, в идеале, хотелось бы всё в одном месте держать, иначе это дополнительная точка отказа)

## Почему git, а не классическая онлайн-вики
Из минусов текущего подхода то, что всё же геморно по сравнению с rentry локально редактировать, если с гитом не работал ранее. Из плюсов то, что если нам обнулят репу, то у всех контрибьютеров останутся локальные копии.

Так-то, при особом желании, можно было бы заморочиться арендовать VPS, и настроить там какой-нибудь вменяемый вики-движок с онлайн-редактором и базой данных, но не нравится мне система с единой точкой отказа. Но, возможно, такой вариант был бы лучше в том плане, что было бы проще новым людям к проекту подключаться. Я открыт к предложениям в этом плане.
